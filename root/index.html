<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Music Player - Justice Ampofo</title>

        <link rel="stylesheet" href="css/style.css">
    </head>

    <body>
      <div id="wrapper">
        <h1>Music Player</h1>
        <div id="songChoice">Song 1:Earth</div>
        <div id="songState">Pause</div>
      	<audio id="myAudio">
          <source id="theSource" src="music/Earth.mp3" type="audio/mp3">
        </audio>

        <canvas id="myCanvas" width="400" height="400"></canvas>

        <div id="myProgress">
          <span id="myBar"></span>
        </div>

        <div id="buttonControls">
          <button id="myPreviousButton">Previous</button>
          <button id="myPlayButton">Play</button>
          <button id="myPauseButton">Pause</button>
          <button id="myNextButton">Next</button>
        </div>

        <form>
          <ul>
            <li>
              <input type="checkbox" id="repeat" name="repeat">
              <label for="repeat">Repeat</label>
            </li>

            <li>
              <input type="checkbox" id="shuffle" name="shuffle">
              <label for="shuffle">Shuffle</label>
            </li>

            <li>
              <input id="vol-col" type="range" min="0" max="100" value="50"  oninput="setVolume(this.value)" onchange="setVolume(this.value)" />
              <label for="vol-col">Volume</label>
            </li>
          </ul>
        </form>

        <script> ////////////////////////////////

          //Get the canvas element
          var canvas = document.getElementById('myCanvas');
          var context = canvas.getContext('2d');

          //draw earth background function
          function drawBackground()
          {
            var gradient = context.createLinearGradient(0, 0, 0, 500);
            gradient.addColorStop(0, 'green');
            gradient.addColorStop(1, 'brown');
            context.fillStyle = gradient;
            context.fillRect(0, 0, 500, 500);

          }

          //draw fire background function
          function drawFireBackground()
          {
            var gradient = context.createLinearGradient(0, 0, 0, 500);
            gradient.addColorStop(0, 'red');
            gradient.addColorStop(1, 'black');
            context.fillStyle = gradient;
            context.fillRect(0, 0, 500, 500);
          }

          //draw Water background function
          function drawWaterBackground()
          {
            var gradient = context.createLinearGradient(0, 0, 0, 500);
            gradient.addColorStop(0, 'blue');
            gradient.addColorStop(1, 'cyan');
            context.fillStyle = gradient;
            context.fillRect(0, 0, 500, 500);
          }

          //draw Ice background function
          function drawIceBackground()
          {
            var gradient = context.createLinearGradient(0, 0, 0, 500);
            gradient.addColorStop(0, 'cyan');
            gradient.addColorStop(1, 'blue');
            context.fillStyle = gradient;
            context.fillRect(0, 0, 500, 500);
          }

          //draw Light background function
          function drawLightBackground()
          {
            var gradient = context.createLinearGradient(0, 0, 0, 500);
            gradient.addColorStop(0, 'lightyellow');
            gradient.addColorStop(1, 'yellow');
            context.fillStyle = gradient;
            context.fillRect(0, 0, 500, 500);
          }

          //draw Boss background function
          function drawBossBackground()
          {
            var gradient = context.createLinearGradient(0, 0, 0, 500);
            gradient.addColorStop(0, 'purple');
            gradient.addColorStop(1, 'black');
            context.fillStyle = gradient;
            context.fillRect(0, 0, 500, 500);
          }

          //Draw the sun
          function drawSun()
          {
            context.beginPath();
  					context.arc(380,20,50,0, Math.PI * 2);
            context.fillStyle = 'yellow';
  					context.fill();
          }

          //Draw the moving clouds
          function drawClouds(x,y)
          {
            context.beginPath();
            context.arc(x-80, y+20, 20, 0, Math.PI * 2);
            context.arc(x-40, y+10, 30, 0, Math.PI * 2);
            context.arc(x, y, 40, 0, Math.PI * 2);
            context.fillStyle = 'white';
            context.fill();
          }

          //Get the button elements
          var previousButton = document.getElementById('myPreviousButton');
  				var playButton = document.getElementById('myPlayButton');
          var pauseButton = document.getElementById('myPauseButton');
          var nextButton = document.getElementById('myNextButton');

  				//Get the audio element
  				var audio = document.getElementById('myAudio');

          //Create song variable
          var songs = 1;

          //Get the div elements and source element
          var songElement = document.getElementById('songChoice');
          var element = document.getElementById('songState');
          var source = document.getElementById('theSource');


          //Switching Song function
          function changeSong()
          {
            //The if statments are checking to see if the player is out of range.
            if(songs == 7)
            {
              songs = 1;
            }
            else if(songs == 0)
            {
              songs = 6;
            }

            //Determined what song to play next and what background to use.
            switch (songs)
            {
              case 1:
                songElement.innerHTML = 'Song 1:Earth';
                element.innerHTML = 'Pause';
                source.src = "music/Earth.mp3";
                audio.load();
                drawBackground();
                drawSun();
                drawClouds(50,100);
              break;

              case 2:
                songElement.innerHTML = 'Song 2:Fire';
                element.innerHTML = 'Pause';
                source.src = "music/Fire.mp3";
                audio.load();
                drawFireBackground();
                drawSun();
                drawClouds(100,100);
              break;

              case 3:
                songElement.innerHTML = 'Song 3:Water';
                element.innerHTML = 'Pause';
                source.src = "music/Water.mp3";
                audio.load();
                drawWaterBackground();
                drawSun();
                drawClouds(200,100);
              break;

              case 4:
                songElement.innerHTML = 'Song 4:Ice';
                element.innerHTML = 'Pause';
                source.src = "music/Ice.mp3";
                audio.load();
                drawIceBackground();
                drawSun();
                drawClouds(250,100);
              break;

              case 5:
                songElement.innerHTML = 'Song 5:Light';
                element.innerHTML = 'Pause';
                source.src = "music/Light.mp3";
                audio.load();
                drawLightBackground();
                drawSun();
                drawClouds(300,100);
              break;

              case 6:
                songElement.innerHTML = 'Song 6:Boss';
                element.innerHTML = 'Pause';
                source.src = "music/Boss.mp3";
                audio.load();
                drawBossBackground();
                drawSun();
                drawClouds(400,100);
              break;

              default:

            }
          } //changeSong ends

          //Update Progress Bar function
          function updateProgress()
          {
             var progress = document.getElementById("myBar");
             var value = 0;
             if (myAudio.currentTime > 0)
             {
                value = Math.floor((100 / myAudio.duration) * myAudio.currentTime);
             }
             progress.style.width = value + "%";
          }

  				playButton.onclick = function()
  				{
  					//Play audio
  					audio.play();
            element.innerHTML = 'Playing!';
  				};

          pauseButton.onclick = function()
          {
            //Pause audio
            audio.pause();
            element.innerHTML = 'Pause';
          };

          //Switch to the next song
          nextButton.onclick = function()
          {
            songs ++;
            if(!audio.paused)
            {
              changeSong();
              audio.play();
              element.innerHTML = 'Playing!';
            }
            else
            {
              changeSong();
            }
          };

          //Switch to the previous song
          previousButton.onclick = function()
          {
            songs --;
            if(!audio.paused)
            {
              changeSong();
              audio.play();
              element.innerHTML = 'Playing!';
            }
            else
            {
              changeSong();
            }
          };

          //Play the next song
          audio.onended = function()
          {
            var again = document.getElementById('repeat');
            var rearrange  = document.getElementById('shuffle');
            if(again.checked)
            {
              audio.play();
            }
            else if(rearrange.checked)
            {
              songs = Math.round(Math.random()*6);
              changeSong();
              audio.play();
              element.innerHTML = 'Playing!';
            }
            else
            {
              songs ++;
              changeSong();
              audio.play();
              element.innerHTML = 'Playing!';
            }

          };

          //Controls volume
          function setVolume(val)
          {
            myAudio.volume = val / 100;
          }

          //Draw the background and sun right away.
          drawBackground();
          drawSun();
          drawClouds(50,100);

          //Runs updateProgress() when the timeupdate event happens.
          myAudio.addEventListener("timeupdate", updateProgress, false);


  		</script>
    </div>
  </body>
</html>
